<!DOCTYPE html><html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="description">
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <title>Animancer - 03 Sequence Coroutine</title>
        <link href="/animancer/assets/css/highlight.css" rel="stylesheet">
        <link href="/animancer/assets/css/bootstrap/bootstrap.css" rel="stylesheet">
        <link href="/animancer/assets/css/adminlte/AdminLTE.css" rel="stylesheet">
        <link href="/animancer/assets/css/theme/theme.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/animancer/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/animancer/assets/css/override.css" rel="stylesheet">
        <script src="/animancer/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/animancer/assets/js/bootstrap.min.js"></script>        
        <script src="/animancer/assets/js/app.min.js"></script>         
        <script src="/animancer/assets/js/highlight.pack.js"></script>   
        <script src="/animancer/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/animancer/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/animancer/assets/js/mermaid.min.js"></script>
        <script src="/animancer/assets/js/svg-pan-zoom.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/animancer/assets/js/html5shiv.min.js"></script>
        <script src="/animancer/assets/js/respond.min.js"></script>
        <![endif]-->  

        
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/animancer/" class="logo">
                            <span>Animancer</span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li class="active"><a href="/animancer/docs"><img src="/animancer/images/docs.png" height="20" style="position:relative; left:-5px; top:-1px;"> Docs</a></li>
        <li><a href="/animancer/faq"><img src="/animancer/images/faq.png" height="20" style="position:relative; left:-4px; top:-1px;"> FAQ</a></li>
        <li><a href="/animancer/api/Animancer/AnimancerComponent"><img src="/animancer/images/api.png" height="20" style="position:relative; left:-3px; top:-1px;"> API v3.0</a></li>
        <li><a href="https://forum.unity.com/threads/566452"><img src="/animancer/images/forum.png" height="20" style="position:relative; left:-4px; top:-1px;"> Forum</a></li>
        <li><a href="mailto:AnimancerUnityPlugin@gmail.com?subject=Animancer"><img src="/animancer/images/contact.png" height="20" style="position:relative; left:-4px; top:-1px;"> Contact</a></li>
        <li><a href="http://u3d.as/19Xd"><img src="/animancer/images/unity-logo.png" height="20" style="position:relative; left:-4px; top:-1px;"> Try</a></li>
        <li><a href="http://u3d.as/19Xb"><img src="/animancer/images/unity-logo.png" height="20" style="position:relative; left:-4px; top:-1px;"> Buy</a></li>
        <li><a href="https://kybernetikgames.github.io/kailas-dierk/unity-assets"><img src="/animancer/images/kybernetik.png" height="20" style="position:relative; left:-2px; top:-1px;"> Other Assets</a></li>
 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
    <div id="infobar-headings"><h6>On This Page</h6><p><a href="#tutorial">Tutorial</a></p>
<p><a href="#basic-script">Basic Script</a></p>
<p><a href="#basic-coroutine">Basic Coroutine</a></p>
<p><a href="#using-the-sequence">Using the Sequence</a></p>
<p><a href="#animation-names">Animation Names</a></p>
<p><a href="#animation-durations">Animation Durations</a></p>
<p><a href="#alternate-loop-duration">Alternate Loop Duration</a></p>
<p><a href="#individual-details">Individual Details</a></p>
<p><a href="#custom-serializables">Custom Serializables</a></p>
<hr class="infobar-hidden">
</div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

                <li class="treeview">
                    <a href="/animancer/docs/introduction">Introduction</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/feature-comparison">Feature Comparison</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer">Mecanim vs. Animancer</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why-replace-mecanim">Why Replace Mecanim?</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/play-an-animation">Play an Animation</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/wait-for-animation">Wait for Animation</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/speed-and-time">Speed and Time</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/weapon-animations">Weapon Animations</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/glossary">Glossary</a></li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/docs/examples">Examples</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview active">
                    <a href="/animancer/docs/examples/basics">01 Basics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/basics/basic-scene-setup">Basic Scene Setup</a></li>
                <li><a href="/animancer/docs/examples/basics/simple-playing">01 Simple Playing</a></li>
                <li><a href="/animancer/docs/examples/basics/playing-and-fading">02 Playing and Fading</a></li>
                <li class="selected"><a href="/animancer/docs/examples/basics/sequence-coroutine">03 Sequence Coroutine</a></li>
                <li><a href="/animancer/docs/examples/basics/named-animations">04 Named Animations</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/fine-control">02 Fine Control</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/fine-control/spider-bot">01 Spider Bot</a></li>
                <li><a href="/animancer/docs/examples/fine-control/doors">02 Doors</a></li>
                <li><a href="/animancer/docs/examples/fine-control/solo-animation">03 Solo Animation</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/locomotion">03 Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/locomotion/walk-and-run">01 Walk and Run</a></li>
                <li><a href="/animancer/docs/examples/locomotion/linear-blending">02 Linear Blending</a></li>
                <li><a href="/animancer/docs/examples/locomotion/directional-blending">03 Directional Blending</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/directional-sprites">04 Directional Sprites</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/directional-sprites/basic-movement">01 Basic Movement</a></li>
                <li><a href="/animancer/docs/examples/directional-sprites/character-controller">02 Character Controller</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animation-events">05 Animation Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animation-events/simple-and-end-events">01 Simple and End Events</a></li>
                <li><a href="/animancer/docs/examples/animation-events/other-events">02 Other Events</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/state-machines">06 State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/state-machines/creatures">01 Creatures</a></li>
                <li><a href="/animancer/docs/examples/state-machines/interrupt-management">02 Interrupt Management</a></li>
                <li><a href="/animancer/docs/examples/state-machines/brains">03 Brains</a></li>
                <li><a href="/animancer/docs/examples/state-machines/more-brains">04 More Brains</a></li>
                <li><a href="/animancer/docs/examples/state-machines/platformer">05 Platformer</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/layers">07 Layers</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/inverse-kinematics">08 Inverse Kinematics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/inverse-kinematics/puppet">01 Puppet</a></li>
                <li><a href="/animancer/docs/examples/inverse-kinematics/uneven-ground">02 Uneven Ground</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual">User Manual</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/playing-animations">Playing Animations</a></li>
                <li><a href="/animancer/docs/manual/states">States</a></li>
                <li><a href="/animancer/docs/manual/inspector">Inspector</a></li>
                <li><a href="/animancer/docs/manual/component-types">Component Types</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending">Blending</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/blending/fading">Fading</a></li>
                <li><a href="/animancer/docs/manual/blending/layers">Layers</a></li>
                <li><a href="/animancer/docs/manual/blending/mixers">Mixers</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/manual/finite-state-machines">Finite State Machines</a></li>
                <li><a href="/animancer/docs/manual/state-serializables">State Serializables</a></li>
                <li><a href="/animancer/docs/manual/animator-controllers">Animator Controllers</a></li>
                <li><a href="/animancer/docs/manual/animation-events">Animation Events</a></li>
                <li><a href="/animancer/docs/manual/inverse-kinematics">Inverse Kinematics</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/bugs">Unity Bugs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/bugs/inconsistent-timing">Inconsistent Timing</a></li>
                <li><a href="/animancer/docs/bugs/paused-skinned-mesh-update">Paused Skinned Mesh Update</a></li>
                <li><a href="/animancer/docs/bugs/resetting-animated-values">Resetting Animated Values</a></li>
                <li><a href="/animancer/docs/bugs/root-motion-interpolation">Root Motion Interpolation</a></li>
                <li><a href="/animancer/docs/bugs/unused-graph-destroy-warning">Unused Graph Destroy Warning</a></li>
                <li><a href="/animancer/docs/bugs/update-modes">Update Modes</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/source">Source Code</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/source/performance-benchmarks">Performance Benchmarks</a></li>
                <li><a href="/animancer/docs/source/creating-custom-states">Creating Custom States</a></li>
                <li><a href="/animancer/docs/source/graph-structure">Graph Structure</a></li>
                <li><a href="/animancer/docs/source/asset-sources">Asset Sources</a></li>
                <li><a href="/animancer/docs/source/coding-standard">Coding Standard</a></li>
                <li><a href="/animancer/docs/source/default-script-template">Default Script Template</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/changes">Change Log</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/future-roadmap">Future Roadmap</a></li>
                <li><a href="/animancer/docs/changes/animancer-v3-0">Animancer v3.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v2-0">Animancer v2.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-3">Animancer v1.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-2">Animancer v1.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-1">Animancer v1.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-0">Animancer v1.0</a></li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>03 Sequence Coroutine</h1>
		</section>
	<section class="content">
		<blockquote class="blockquote">
<p><em>Assets/Plugins/Animancer/Examples/01 Basics/03 Sequence Coroutine</em></p>
</blockquote>
<p>This example demonstrates how you can use a coroutine to play through an array of animations in a simple sequence as if to showcase them for a professional portfolio or a pack of animations to release on the Asset Store. Or in a game, this approach could be adapted for a melee attack combo system. It makes use of Animancer's <a href="../../../manual/state-serializables">State Serializables</a> to allow the details of each animation and transition to be easily customised in the Inspector.</p>
<p><img src="sequence-coroutine.gif" class="img-responsive"></p>
<h1 id="tutorial">Tutorial</h1>
<p></p><details><summary>Here's the script we will be building in this tutorial:</summary><p>
</p><p><img src="custom-serializables.png" class="img-responsive"></p>
<pre><code class="language-cs">using Animancer;
using System;
using System.Collections;
using UnityEngine;
using UnityEngine.UI;

public sealed class SequenceCoroutineTutorial : MonoBehaviour
{
    [Serializable]
    public class SequenceClip : <a href="/animancer/api/Animancer/Serializable">ClipState.Serializable</a>
    {
        [Tooltip("Determines how long this animation will play for during the sequence" +
            " (zero will play through the full animation once)")]
        [SerializeField]
        private float _PlayDuration;

        public float PlayDuration
        {
            get { return _PlayDuration; }
            set { _PlayDuration = value; }
        }
    }

    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private Text _Text;

    [SerializeField]
    private SequenceClip[] _Animations;

    private void OnEnable()
    {
        Play(_Animations[0]);
    }

    public void PlaySequence()
    {
        StopAllCoroutines();
        StartCoroutine(CoroutineAnimationSequence());
    }

    private IEnumerator CoroutineAnimationSequence()
    {
        for (int i = 1; i &lt; _Animations.Length; i++)
        {
            var animation = _Animations[i];
            var state = Play(animation);

            if (animation.PlayDuration &gt; 0)
                yield return new WaitForSeconds(animation.PlayDuration);
            else
                yield return state;
        }

        Play(_Animations[0]);
    }

    private <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> Play(ClipState.Serializable animation)
    {
        _Text.text = animation.Clip.name;
        return _Animancer.Transition(animation);
    }
}
</code></pre>
<p></p></details><p></p>
<p>Start by following the <a href="../basic-scene-setup">Basic Scene Setup</a> instructions to create a new scene with the character in it.</p>
<h1 id="basic-script">Basic Script</h1>
<ol>
<li>Create a new script called <code>SequenceCoroutineTutorial</code> and open it up.</li>
<li>Put <code>using Animancer;</code> at the top of the script.</li>
<li>Give it an <code><a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a></code> field and an <code>AnimationClip[]</code> field for the animations in the sequence.</li>
<li>Use the <code>OnEnable</code> method to play the first clip in the sequence.</li>
</ol>
<p></p><details><summary>The script should look like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public sealed class SequenceCoroutineTutorial : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private AnimationClip[] _Animations;

    private void OnEnable()
    {
        _Animancer.Play(_Animations[0]);
    }
}
</code></pre>
<p></p></details><p></p>
<h1 id="basic-coroutine">Basic Coroutine</h1>
<p>We could test it out now, but there's not much point because all it does so far is play a single animation. Instead, let's make the coroutine that will play through each animation in the array in a sequence.</p>
<p>A coroutine is a special type of method with <code>IEnumerator</code> as the return type like so:</p>
<pre><code class="language-cs">private IEnumerator CoroutineAnimationSequence()
{
}
</code></pre>
<p><code>IEnumerator</code> is located in the <code>System.Collections</code> namespace so we need <code>using System.Collections;</code> at the top of the script if it isn't there already. If you are using Visual Studio you can click on <code>IEnumerator</code> and press <code>Ctrl + .</code> to open a menu which allows you to easily add the correct <code>using</code> statement.</p>
<p>At this point it's still a regular method that just happens to return an <code>IEnumerator</code>, not actually a coroutine. For example, we could put in <code>return _Animations.GetEnumerator();</code> to return an object that can be used to iterate through every element of the <code>_Animations</code> array and we could call it like a regular method.</p>
<p>What actually makes it a coroutine is the use of <code>yield</code> statements. For example, we could put in <code>yield break;</code> which ends the method like a <code>return;</code> statement in a regular method. That would get it to stop giving us compiler errors, but all we would have is a coroutine that still does nothing.</p>
<p>To implement our sequence, we want to use a loop to iterate through every animation in the <code>_Animations</code> array and make use of Unity's <code>WaitForSeconds</code> class to wait a bit while each one plays:</p>
<pre><code class="language-cs">private IEnumerator CoroutineAnimationSequence()
{
    // Start at the 2nd animation (index [1]) since we are already playing the 1st.
    for (int i = 1; i &lt; _Animations.Length; i++)
    {
        // Play it.
        _Animancer.Play(_Animations[i]);

        // Wait for 1 second.
        yield return new WaitForSeconds(1);

        // Then go to the next animation.
    }

    // Go back to the 1st animation.
    _Animancer.Play(_Animations[0]);
}
</code></pre>
<p>Obviously playing each animation for the same 1 second duration isn't going to be what we want because they have different lengths, but we will improve that soon (in <a href="#animation-durations">Animation Durations</a>).</p>
<p>The last thing we need before we can go back to Unity and try it out is a method to actually start the coroutine which we will make <code>public</code> so it can be called by a UI <code>Button</code>. Unfortunately we can't simply call <code>CoroutineAnimationSequence();</code> like a normal method because that would only execute it up to the first <code>yield</code> statement. Instead we need to call it and pass the <code>IEnumerator</code> it creates into the <code>StartCoroutine</code> method so Unity knows it needs to continue checking when the next part of the coroutine should be executed (according to the <code>yield</code> statements we put in.</p>
<p>We also want to call <code>StopAllCoroutines</code> first, just in case the button gets clicked again before the previous sequence ends. It wouldn't be very useful to have two sequences running at once (it can be in other situations, but not for this).</p>
<pre><code class="language-cs">public void PlaySequence()
{
    StopAllCoroutines();
    StartCoroutine(CoroutineAnimationSequence());
}
</code></pre>
<p></p><details><summary>The full script now looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using System.Collections;
using UnityEngine;

public sealed class SequenceCoroutineTutorial : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private AnimationClip[] _Animations;

    private void OnEnable()
    {
        _Animancer.Play(_Animations[0]);
    }

    public void PlaySequence()
    {
        StopAllCoroutines();
        StartCoroutine(CoroutineAnimationSequence());
    }

    private IEnumerator CoroutineAnimationSequence()
    {
        for (int i = 1; i &lt; _Animations.Length; i++)
        {
            _Animancer.Play(_Animations[i]);

            yield return new WaitForSeconds(1);
        }

        _Animancer.Play(_Animations[0]);
    }
}
</code></pre>
<p></p></details><p></p>
<h1 id="using-the-sequence">Using the Sequence</h1>
<p>Save the script and go back to the Unity scene so we can see it in action.</p>
<ol>
<li>Add the <code>SequenceCoroutineTutorial</code> script we just created to the <em>LowPolyMan</em> in the scene. It would work regardless of which object we put it on, but there is the most convenient.</li>
<li>Assign the <em>LowPolyMan</em>'s <code><a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a></code> to the <code>Animancer</code> field on the component we just added.</li>
<li>Assign the animations you want in your sequence to the <code>Animations</code> array, starting with an <em>Idle</em> animation.</li>
</ol>
<p><img src="basic-sequence-inspector.png" class="img-responsive"></p>
<p>Now we need a UI <code>Button</code>:</p>
<ol>
<li>Right click in the Hierarchy window and create a new <em>UI/Button</em>. This creates a <em>Canvas</em> with a <em>Button</em> as its child and an <em>Event System</em>.</li>
<li>Click on the <code>Anchor Presets</code> button in the top left of the <em>Button</em>'s <code>RectTransform</code> component.</li>
<li>Hold both <code>Shift</code> and <code>Alt</code> then click on the <em>Bottom Center</em> preset to move the anchors, pivot, and position to the bottom center of the <em>Canvas</em>.</li>
<li>Go to the <code>On Click</code> event of the <code>Button</code> component and use the <code>+</code> button to add a new function to call.</li>
<li>Drag the <em>LowPolyMan</em> from the Hierarchy window into the object reference field of the new function.</li>
<li>Use the dropdown menu to select the <code>SequenceCoroutineTutorial -&gt; PlaySequence</code> method we created earlier.</li>
</ol>
<p><img src="button-setup.gif" class="img-responsive"></p>
<p>Now if we enter Play Mode we can see the sequence in action.</p>
<p><img src="basic-sequence-play.gif" class="img-responsive"></p>
<p>Don't forget to exit Play Mode once you are done looking.</p>
<h1 id="animation-names">Animation Names</h1>
<p>It would be nice to have a clear indication of which animation is playing, so let's add some text to show the name of the current animation.</p>
<p>Add <code>using UnityEngine.UI;</code> to the top of the script and give it a <code>Text</code> field:</p>
<pre><code class="language-cs">[SerializeField]
private Text _Text;
</code></pre>
<p>Now we need to set the text whenever we play an animation so let's make a new method to do both at once:</p>
<pre><code class="language-cs">private void Play(AnimationClip animation)
{
    _Text.text = animation.name;
    _Animancer.Play(animation);
}
</code></pre>
<p>Then we can change all <code>_Animancer.Play</code> calls to just use that <code>Play</code> method instead.</p>
<p></p><details><summary>The full script now looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using System.Collections;
using UnityEngine;
using UnityEngine.UI;

public sealed class SequenceCoroutineTutorial : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private Text _Text;

    [SerializeField]
    private AnimationClip[] _Animations;

    private void OnEnable()
    {
        Play(_Animations[0]);
    }

    public void PlaySequence()
    {
        StopAllCoroutines();
        StartCoroutine(CoroutineAnimationSequence());
    }

    private IEnumerator CoroutineAnimationSequence()
    {
        for (int i = 1; i &lt; _Animations.Length; i++)
        {
            Play(_Animations[i]);

            yield return new WaitForSeconds(1);
        }

        Play(_Animations[0]);
    }

    private void Play(AnimationClip animation)
    {
        _Text.text = animation.name;
        _Animancer.Play(animation);
    }
}
</code></pre>
<p></p></details><p></p>
<p>Save the script and return to Unity to create and connect the text object.</p>
<ol>
<li>Right click in the Hierarchy window and create a new <em>UI/Text</em>.</li>
<li>Set it to the <em>Stretch Top</em> Anchor Preset to be up the top using the full width of the canvas.</li>
<li>Configure the <code>Text</code> component to be bigger: <code>Font Size = 30</code>, <code>Alignment = Centered</code>, <code>Vertical Overflow = Overflow</code>.</li>
<li>Go to our <code>SequenceCoroutineTutorial</code> component on the <em>LowPolyMan</em> and drag the <em>Text</em> object into the field we just added to the script.</li>
</ol>
<p><img src="create-text.gif" class="img-responsive"></p>
<p>Now in Play Mode we will be able to see the name of the animation being played.</p>
<p><img src="basic-sequence-play-with-text.gif" class="img-responsive"></p>
<p>Don't forget to exit Play Mode once you are done looking.</p>
<h1 id="animation-durations">Animation Durations</h1>
<p>Giving every animation the same arbitrary duration is clearly not the best way to do things because each animation can have a different length. Fortunately, since we have the <code>AnimationClip</code>s, we have direct access to their <code>length</code>s so we could change the <code>WaitForSeconds</code> instruction to use that instead of a constant 1:</p>
<pre><code class="language-cs">var animation = _Animations[i];
_Animancer.Play(animation);
yield return new WaitForSeconds(animation.length);
</code></pre>
<p>That would definitely get the job done for this situation, but it is not necessarily the best way to do it in other cases. For example, if something else started a different animation or changed the speed of this one, the coroutine would still be waiting for the original fixed amount of time.</p>
<p>Instead, we can change our <code>Play</code> method to return the <code><a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a></code> it gets from the <code>_Animancer.Play</code> method and use that state as the <code>yield</code> instruction. This will wait until that state either stops playing or reaches the end for any reason, including any interruptions, speed changes, or even direct manipulation of its <code>Time</code> property.</p>
<pre><code class="language-cs">private <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> Play(AnimationClip animation)
{
    _Text.text = animation.name;
    return _Animancer.Play(animation);
}

...

var animation = _Animations[i];
var state = Play(animation);
yield return state;
</code></pre>
<p></p><details><summary>The full script now looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using System.Collections;
using UnityEngine;
using UnityEngine.UI;

public sealed class SequenceCoroutineTutorial : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private Text _Text;

    [SerializeField]
    private AnimationClip[] _Animations;

    private void OnEnable()
    {
        Play(_Animations[0]);
    }

    public void PlaySequence()
    {
        StopAllCoroutines();
        StartCoroutine(CoroutineAnimationSequence());
    }

    private IEnumerator CoroutineAnimationSequence()
    {
        for (int i = 1; i &lt; _Animations.Length; i++)
        {
            var animation = _Animations[i];
            var state = Play(animation);
            yield return state;
        }

        Play(_Animations[0]);
    }

    private <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> Play(AnimationClip animation)
    {
        _Text.text = animation.name;
        return _Animancer.Play(animation);
    }
}
</code></pre>
<p></p></details><p></p>
<p>And if we try it in Play Mode, this time it will play through each animation fully.</p>
<p><img src="sequence-with-basic-time.gif" class="img-responsive"></p>
<p>Don't forget to exit Play Mode once you are done looking.</p>
<h1 id="alternate-loop-duration">Alternate Loop Duration</h1>
<p>Playing through each animation once works well for non-looping animations like <em>GolfSwing</em>, but not so well for looping ones. <em>Walk</em> and <em>Run</em> only play one step with each foot and <em>GolfSwingReady</em> only shows for a brief moment since it is not much more than a stationary pose.</p>
<p>So let's add another field to specify the duration to show looping animations.</p>
<pre><code class="language-cs">[SerializeField]
private float _LoopDuration = 3;
</code></pre>
<p>3 seconds seems like a reasonable default value, but since it's a serializable field we can use the Inspector to adjust it if we want to.</p>
<p>Now we can use that field in our coroutine depending on whether each animation is looping or not:</p>
<pre><code class="language-cs">var animation = _Animations[i];
var state = Play(animation);

if (animation.isLooping)
    yield return new WaitForSeconds(_LoopDuration);
else
    yield return state;
</code></pre>
<p></p><details><summary>The full script now looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using System.Collections;
using UnityEngine;
using UnityEngine.UI;

public sealed class SequenceCoroutineTutorial : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private Text _Text;

    [SerializeField]
    private float _LoopDuration = 3;

    [SerializeField]
    private AnimationClip[] _Animations;

    private void OnEnable()
    {
        Play(_Animations[0]);
    }

    public void PlaySequence()
    {
        StopAllCoroutines();
        StartCoroutine(CoroutineAnimationSequence());
    }

    private IEnumerator CoroutineAnimationSequence()
    {
        for (int i = 1; i &lt; _Animations.Length; i++)
        {
            var animation = _Animations[i];
            var state = Play(animation);

            if (animation.isLooping)
                yield return new WaitForSeconds(_LoopDuration);
            else
                yield return state;
        }

        Play(_Animations[0]);
    }

    private <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> Play(AnimationClip animation)
    {
        _Text.text = animation.name;
        return _Animancer.Play(animation);
    }
}
</code></pre>
<p></p></details><p></p>
<p>And if we try it in Play Mode, we get to see the looping animations for 3 seconds each while the <em>GolfSwing</em> just plays its full length once.</p>
<p><img src="sequence-with-loop-time.gif" class="img-responsive"></p>
<p>Don't forget to exit Play Mode once you are done looking.</p>
<h1 id="individual-details">Individual Details</h1>
<p>What we have made so far works pretty well, but doesn't give us any convenient way to adjust the details of the individual animations. For example, the <em>GolfSwingReady</em> animation is just a stationary pose so it really doesn't need the same 3 seconds that we give <em>Walk</em> and <em>Run</em>.</p>
<p>We could add a simple <code>float[]</code> field with each element corresponding to an element in the <code>_Animations</code> array, but that wouldn't be particularly convenient to work with in the Inspector and would rely on the user to always make sure both arrays have the same size. This would be even worse if we wanted to specify transition durations and play speeds as well.</p>
<p>This is where Animancer's <a href="../../../manual/state-serializables">State Serializables</a> come in. They are serializable classes that package additional fields along with each <code>AnimationClip</code>.</p>
<p>So let's make a few changes to the script:</p>
<ol>
<li>Change the <code>_Animations</code> field type to <code>ClipState.Serializable[]</code>.</li>
<li>Change the <code>Play</code> method parameter type to <code><a href="/animancer/api/Animancer/Serializable">ClipState.Serializable</a></code> as well.</li>
<li>Have it get the animation name from <code>animation.Clip.name</code> instead of just <code>animation.name</code>.</li>
<li>Have it call <code>Transition</code> instead of <code>Play</code>.</li>
<li>Also change the condition in the coroutine to check <code>animation.Clip.isLooping</code> instead of just <code>animation.isLooping</code>.</li>
</ol>
<p></p><details><summary>The full script now looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using System.Collections;
using UnityEngine;
using UnityEngine.UI;

public sealed class SequenceCoroutineTutorial : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private Text _Text;

    [SerializeField]
    private float _LoopDuration = 3;

    [SerializeField]
    private ClipState.Serializable[] _Animations;

    private void OnEnable()
    {
        Play(_Animations[0]);
    }

    public void PlaySequence()
    {
        StopAllCoroutines();
        StartCoroutine(CoroutineAnimationSequence());
    }

    private IEnumerator CoroutineAnimationSequence()
    {
        for (int i = 1; i &lt; _Animations.Length; i++)
        {
            var animation = _Animations[i];
            var state = Play(animation);

            if (animation.Clip.isLooping)
                yield return new WaitForSeconds(_LoopDuration);
            else
                yield return state;
        }

        Play(_Animations[0]);
    }

    private <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> Play(ClipState.Serializable animation)
    {
        _Text.text = animation.Clip.name;
        return _Animancer.Transition(animation);
    }
}
</code></pre>
<p></p></details><p></p>
<p>Unfortunately, changing the field from direct <code>AnimationClip</code> references to classes that happen to contain <code>AnimationClip</code> references means that Unity will lose the references we assigned earlier, so you need to select the <em>LowPolyMan</em> and assign all the animations again.</p>
<p><img src="serializables-collapsed.png" class="img-responsive"></p>
<p>You might have noticed those foldout arrows next to each of the fields. Clicking on them will show the new details we get for using <code><a href="/animancer/api/Animancer/Serializable">ClipState.Serializable</a></code>s.</p>
<p><img src="serializables-expanded.png" class="img-responsive"></p>
<h1 id="custom-serializables">Custom Serializables</h1>
<p>Feel free to try modifying any of those values if you like. For example, you could set the <code>Fade Duration</code>s to 0 so it snaps instantly to each new animations like when we were using <code>_Animancer.Play</code> before. Note that these are all Pro-Only details, meaning that they will have no effect in runtime builds unless you are using Animancer Pro (but Animancer Lite still allows you to try them out in the Unity Editor and will give you a warning so that you know they are Pro-Only).</p>
<p>What we actually want is a <code>PlayDuration</code> specifically for our sequence which we aren't going to get from the inbuilt serializable type, but we can add it by making a new class that inherits from <code><a href="/animancer/api/Animancer/Serializable">ClipState.Serializable</a></code>:</p>
<pre><code class="language-cs">[Serializable]
public class SequenceClip : <a href="/animancer/api/Animancer/Serializable">ClipState.Serializable</a>
{
    [SerializeField]
    private float _PlayDuration;

    public float PlayDuration
    {
        get { return _PlayDuration; }
        set { _PlayDuration = value; }
    }
}
</code></pre>
<p>In this situation we don't really gain anything by using a <code>private</code> field with a property other than to continue following the same coding conventions we have used so far. A <code>public</code> field would do the job even easier and would be perfectly acceptable since this class is just holding a bunch of data and isn't performing any validation or performing other operations based on that data.</p>
<p>Now we can change the type of the <code>_Animations</code> field to our new <code>SequenceClip</code> type, remove the <code>_LoopDuration</code> field, and use the individual duration in the coroutine instead:</p>
<pre><code class="language-cs">var animation = _Animations[i];
var state = Play(animation);

if (animation.PlayDuration &gt; 0)
    yield return new WaitForSeconds(animation.PlayDuration);
else
    yield return state;
</code></pre>
<p>This demonstrates one of the main advantages of the <code>var</code> keyword. If we had originally declared it as <code>AnimationClip animation = ...</code>, we would have had to change it to <code><a href="/animancer/api/Animancer/Serializable">ClipState.Serializable</a> animation = ...</code> and then to <code>SequenceClip animation = ...</code>, yet with the <code>var</code> keyword we haven't had to touch that line at all since we first wrote it. When we get an element from the array we almost always want that same type by default.</p>
<p>Let's also give the field a tooltip to show in the Inspector to help explain what its for when someone else tries to use this script so they don't need to look at the code:</p>
<pre><code class="language-cs">[Tooltip("Determines how long this animation will play for during the sequence" +
    " (zero will play through the full animation once)")]
[SerializeField]
private float _PlayDuration = 3;
</code></pre>
<p></p><details><summary>The final script looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using System;
using System.Collections;
using UnityEngine;
using UnityEngine.UI;

public sealed class SequenceCoroutineTutorial : MonoBehaviour
{
    [Serializable]
    public class SequenceClip : <a href="/animancer/api/Animancer/Serializable">ClipState.Serializable</a>
    {
        [Tooltip("Determines how long this animation will play for during the sequence" +
            " (zero will play through the full animation once)")]
        [SerializeField]
        private float _PlayDuration;

        public float PlayDuration
        {
            get { return _PlayDuration; }
            set { _PlayDuration = value; }
        }
    }

    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private Text _Text;

    [SerializeField]
    private SequenceClip[] _Animations;

    private void OnEnable()
    {
        Play(_Animations[0]);
    }

    public void PlaySequence()
    {
        StopAllCoroutines();
        StartCoroutine(CoroutineAnimationSequence());
    }

    private IEnumerator CoroutineAnimationSequence()
    {
        for (int i = 1; i &lt; _Animations.Length; i++)
        {
            var animation = _Animations[i];
            var state = Play(animation);

            if (animation.PlayDuration &gt; 0)
                yield return new WaitForSeconds(animation.PlayDuration);
            else
                yield return state;
        }

        Play(_Animations[0]);
    }

    private <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> Play(ClipState.Serializable animation)
    {
        _Text.text = animation.Clip.name;
        return _Animancer.Transition(animation);
    }
}
</code></pre>
<p></p></details><p></p>
<p>Now we have a <code>Play Duration</code> field for each animation, so let's change <em>Walk</em> and <em>Run</em> to use the same 3 seconds we were using before, but have <em>GolfSwingReady</em> use only 1 second.</p>
<p><img src="custom-serializables.png" class="img-responsive"></p>
<p>And here's out final result.</p>
<p><img src="sequence-custom-serializable.gif" class="img-responsive"></p>
<p>That's all for now. Further extension of this example could add more details such as a prefab field in the <code>SequenceClip</code> class which will be instantiated in the character's hand when playing that animation so we can give him a golf club when performing the golf animations.</p>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                Generated by <a href="https://wyam.io">Wyam</a>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).ready(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });     
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-responsive');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});			                          

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();
                    
                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });

            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    
</body></html>